{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../OffscreenCanvasTableWorker/src/OffscreenCanvasTableWorker.ts","webpack:///../share/CanvasTableColum.ts","webpack:///../share/CircularBuffer.ts","webpack:///../share/CustomCanvasIndex.ts","webpack:///../share/CustomCanvasTable.ts","webpack:///../share/OffscreenCanvasTableMessage.ts","webpack:///../share/ScrollView.ts","webpack:///./worker.ts"],"names":[],"mappings":"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","file":"dist/worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./worker.ts\");\n","import { CustomCanvasTable, CanvasTableConfig } from \"../../share/CustomCanvasTable\";\r\nimport { ScrollView } from \"../../share/ScrollView\";\r\nimport { OffscreenCanvasMesssage, OffscreenCanvasMesssageType } from \"../../share/OffscreenCanvasTableMessage\";\r\nimport { CanvasTableColumnConf } from \"../../share/CanvasTableColum\";\r\n\r\nexport class OffscreenCanvasTableWorker extends CustomCanvasTable {\r\n    protected drawCanvas(): void {\r\n        if (this.context === undefined || this.dataIndex === undefined) { \r\n            this.requestAnimationFrame = undefined;\r\n            this.askForReDraw(this.drawconf);\r\n            return; \r\n        }\r\n\r\n        super.drawCanvas();\r\n    }\r\n\r\n    protected setCanvasSize(width: number, height: number): void {\r\n        if (this.canvas === undefined) { return; }\r\n        this.canvas.width = width;\r\n        this.canvas.height = height;\r\n        super.setCanvasSize(width, height);\r\n    }\r\n\r\n    private id: number;\r\n    private canvas?: OffscreenCanvas;\r\n\r\n    constructor (offscreenCanvasTableId: number, col: CanvasTableColumnConf[], config?: CanvasTableConfig){\r\n        super(config);\r\n        this.id = offscreenCanvasTableId;\r\n        this.UpdateColumns(col);\r\n    }\r\n\r\n    public message(data: OffscreenCanvasMesssage) {\r\n        if (data.mthbCanvasTable !== this.id) { return; }\r\n\r\n        switch (data.type) {\r\n            case OffscreenCanvasMesssageType.create:\r\n                this.canvas = data.offscreen;                    \r\n                this.setR(data.r);\r\n                const context = this.canvas.getContext('2d');\r\n                if (context === null) { return; }\r\n                this.scrollView = new ScrollView(context, this, this.config ? this.config.scrollView : undefined, this.askForExtentedMouseMoveAndMaouseUp, this.askForNormalMouseMoveAndMaouseUp);\r\n\r\n                this.context = context; \r\n                this.doReize(data.width, data.height);                   \r\n                this.askForReDraw();\r\n                break;\r\n            case OffscreenCanvasMesssageType.resize:\r\n                this.setR(data.r);\r\n                this.doReize(data.width, data.height);                   \r\n                this.askForReDraw();\r\n                break;\r\n            case OffscreenCanvasMesssageType.collapseAll:\r\n                this.collapseAll();\r\n                break;\r\n            case OffscreenCanvasMesssageType.expendAll:\r\n                this.expendAll();\r\n                break;\r\n            case OffscreenCanvasMesssageType.setGroupBy:\r\n                this.setGroupBy(data.groupBy);\r\n                break;\r\n            case OffscreenCanvasMesssageType.scroll:\r\n                this.wheel(data.deltaMode, data.deltaX, data.deltaY);\r\n                break;\r\n            case OffscreenCanvasMesssageType.mouseDown:\r\n                this.mouseDown(data.x, data.y);\r\n                break;\r\n            case OffscreenCanvasMesssageType.mouseMove:\r\n                this.mouseMove(data.x, data.y);\r\n                break;\r\n            case OffscreenCanvasMesssageType.mouseUp:\r\n                this.mouseUp(data.x, data.y);\r\n                break;\r\n            case OffscreenCanvasMesssageType.mouseMoveExtended:\r\n                this.mouseMoveExtended(data.x, data.y);\r\n                break;\r\n            case OffscreenCanvasMesssageType.mouseUpExtended:\r\n                this.mouseUpExtended(data.x, data.y);\r\n                break;\r\n            case OffscreenCanvasMesssageType.mouseLeave:\r\n                this.mouseLeave();\r\n                break;\r\n            case OffscreenCanvasMesssageType.TouchStart:\r\n                this.TouchStart(data.event, data.offsetLeft, data.offsetTop);\r\n                break;\r\n            case OffscreenCanvasMesssageType.TouchMove:\r\n                this.TouchMove(data.event, data.offsetLeft, data.offsetTop);\r\n                break;\r\n            case OffscreenCanvasMesssageType.TouchEnd:\r\n                this.TouchEnd(data.event, data.offsetLeft, data.offsetTop);\r\n                break;\r\n            case OffscreenCanvasMesssageType.keyDown:\r\n                this.keydown(data.keycode);\r\n                break;\r\n        }\r\n    }\r\n\r\n    protected resize() {}\r\n    protected setCursor(cursor: string): void {\r\n        const data:OffscreenCanvasMesssage = { mthbCanvasTable:this.id, type:OffscreenCanvasMesssageType.setCursor, cursor: cursor };\r\n        postMessage(data);\r\n    }\r\n    protected askForExtentedMouseMoveAndMaouseUp() {\r\n        const data:OffscreenCanvasMesssage = { mthbCanvasTable:this.id, type:OffscreenCanvasMesssageType.askForExtentedMouseMoveAndMaouseUp };\r\n        postMessage(data);\r\n    }\r\n    protected askForNormalMouseMoveAndMaouseUp() {\r\n        const data:OffscreenCanvasMesssage = { mthbCanvasTable:this.id, type:OffscreenCanvasMesssageType.askForNormalMouseMoveAndMaouseUp };\r\n        postMessage(data);\r\n    }\r\n}","import { CustomCanvasTable } from \"./CustomCanvasTable\";\r\nimport { CanvasContext2D } from \"./CanvasContext2D\";\r\n\r\nexport type CustomData = (canvasTable: CustomCanvasTable, dataValue: any, row: any, data: any, rowIndex: number, col: CanvasTableColumnConf) => string;\r\nexport type RenderValue = (canvasTable: CustomCanvasTable, context: CanvasContext2D, rowIndex: number, col: CanvasTableColumnConf, left: number, top: number, right: number, bottom: number, width: number, height: number, r: number, dataValue: any, row: any, data: any) => void;\r\nexport type CustomFilter = (data: any, row: any, col: CanvasTableColumnConf[]) => boolean;\r\nexport type CustomSort = (data: any, rowA: any, rowB: any) => number;\r\n\r\nexport interface CanvasTableColumnConf {\r\n    header: string;\r\n    field: string;\r\n    width?: number;\r\n    align?: Align;\r\n    visible?: boolean;\r\n    renderer?: RenderValue;\r\n    customData?: CustomData;\r\n}\r\n\r\nexport interface CanvasTableColumnSort {\r\n    col: CanvasTableColumnConf,\r\n    sort: Sort\r\n}\r\n\r\nexport enum Align { left, center, right }\r\nexport enum Sort { ascending = 1, descending = -1 }\r\n","/**\r\n * Circular buffer\r\n */\r\nexport class CircularBuffer<T = any> {\r\n  private pointerWrite = 0;\r\n  private pointerRead = 0;\r\n  private buffer: (T | undefined)[];\r\n  private length: number;\r\n  private count = 0;\r\n  private allowOverFlow: boolean;\r\n\r\n  /**\r\n   * constructor of CircularBuffer\r\n   * @param [length=50] Size of buffer\r\n   * @param [allowOverFlow=true] allow to push when buffer is full, you will lose data\r\n   */\r\n  public constructor(length: number = 50, allowOverFlow: boolean = true) {\r\n    this.length = length;\r\n    this.allowOverFlow = allowOverFlow;\r\n    this.buffer = new Array(this.length);\r\n  }\r\n  /**\r\n   * count of item in list\r\n   * @returns {number} size of list\r\n   */\r\n  public size(): number {\r\n    return this.count;\r\n  }\r\n  /**\r\n   * pop out from lista last\r\n   * @returns {T} oldes item\r\n   */\r\n  public pop(): T {\r\n    if (this.count === 0) {\r\n      throw \"empty\";\r\n    }\r\n    const i = this.pointerRead;\r\n    this.pointerRead = (this.length + this.pointerRead + 1) % this.length;\r\n    this.count--;\r\n    const temp = this.buffer[i];\r\n    if (temp === undefined) {\r\n      throw \"undefined\";\r\n    }\r\n    this.buffer[i] = undefined;\r\n    return temp;\r\n  }\r\n\r\n  /**\r\n   * Push item in circular buffer\r\n   * @param item {T} item\r\n   */\r\n  public push(item: T): void {\r\n    if (!this.allowOverFlow && this.count === this.length) {\r\n      throw \"overflow\";\r\n    }\r\n    this.buffer[this.pointerWrite] = item;\r\n    this.pointerWrite = (this.length + this.pointerWrite + 1) % this.length;\r\n    if (this.count === this.length) {\r\n      this.pointerRead = this.pointerWrite;\r\n    } else {\r\n      this.count++;\r\n    }\r\n  }\r\n  /**\r\n   * Empty the circle buffer\r\n   */\r\n  public clear(): void {\r\n    this.pointerRead = 0;\r\n    this.pointerWrite = 0;\r\n    this.count = 0;\r\n    this.buffer = new Array(this.length);\r\n  }\r\n\r\n  /**\r\n   * pop all item\r\n   * @returns {T[]} list\r\n   */\r\n  public export(): T[] {\r\n    let result: T[] = [];\r\n    while (this.size() > 0) {\r\n      result[result.length] = this.pop();\r\n    }\r\n\r\n    return result;\r\n  }\r\n}\r\n","export enum ItemIndexType { GroupItems, Index }\r\nexport interface GroupItems {\r\n    type: ItemIndexType.GroupItems,\r\n    list: GroupItem[]\r\n}\r\n\r\nexport interface GroupItem {\r\n    caption: string,\r\n    child: (GroupItems|Index),\r\n    isExpended: boolean\r\n}\r\nexport interface Index {\r\n    type: ItemIndexType.Index,\r\n    list: number[]\r\n}\r\nexport type IndexType = Index | GroupItems;","import { Drawable } from \"./Drawable\";\r\nimport { ScrollView, ScrollViewConfig } from \"./ScrollView\";\r\nimport { CanvasContext2D, CanvasColor } from \"./CanvasContext2D\";\r\nimport { CanvasTableTouchEvent } from \"./CanvasTableTouchEvent\";\r\nimport { Align, RenderValue, CustomData, CanvasTableColumnConf, CustomFilter, CustomSort, CanvasTableColumnSort, Sort } from \"./CanvasTableColum\";\r\nimport { IndexType, ItemIndexType, GroupItem, GroupItems, Index } from \"./CustomCanvasIndex\";\r\nexport interface DrawConfig {\r\n    drawOnly?: number[]\r\n}\r\n\r\ndeclare function setTimeout(callback: (...args: any[]) => void, ms: number, ...args: any[]): number;\r\nexport interface CanvasTableConfig {\r\n    scrollView?: ScrollViewConfig,\r\n    font?: string,\r\n    fontStyle?: string,\r\n    fontSize?: number,\r\n    fontColor?: CanvasColor,\r\n    headerFont?: string,\r\n    headerFontStyle?: string,\r\n    headerFontSize?: number,\r\n    headerFontColor?: CanvasColor,\r\n    headerDrawSortArrow?: boolean,\r\n    headerDrawSortArrowColor?: CanvasColor,\r\n    headerBackgroundColor?: CanvasColor,\r\n    backgroundColor?: CanvasColor,\r\n    lineColor?: CanvasColor,\r\n    howerBackgroundColor?: CanvasColor,\r\n    sepraBackgroundColor?: CanvasColor\r\n}\r\n\r\ninterface CanvasTableConf {\r\n    scrollView?: ScrollViewConfig,\r\n    font: string,\r\n    fontStyle: string,\r\n    fontSize: number,\r\n    fontColor: CanvasColor,\r\n    headerFont: string,\r\n    headerFontStyle: string,\r\n    headerFontSize: number,\r\n    headerFontColor: CanvasColor,\r\n    headerDrawSortArrow: boolean,\r\n    headerDrawSortArrowColor: CanvasColor,\r\n    headerBackgroundColor: CanvasColor,\r\n    backgroundColor: CanvasColor,\r\n    lineColor: CanvasColor,\r\n    howerBackgroundColor: CanvasColor,\r\n    sepraBackgroundColor: CanvasColor\r\n}\r\n\r\ninterface CanvasTableColumn {\r\n    header: string,\r\n    field: string,\r\n    width: number,\r\n    align: Align,\r\n    leftPos: number,\r\n    rightPos: number,\r\n    renderer?: RenderValue,\r\n    customData?: CustomData,\r\n    orginalCol: CanvasTableColumnConf\r\n}\r\n\r\nexport abstract class CustomCanvasTable implements Drawable {\r\n    private needToCalc: boolean = true;\r\n    private needToCalcFont: boolean = true;\r\n    protected context?: CanvasContext2D;\r\n    protected requestAnimationFrame?: number;\r\n    protected drawconf?: DrawConfig & { fulldraw: boolean };\r\n    protected r: number = 1;\r\n    protected data: any[] = [];\r\n\r\n    private minFontWidth: number = 1;\r\n    private maxFontWidth: number = 1;\r\n\r\n    protected scrollView?: ScrollView;\r\n\r\n    protected cellHeight = 20;\r\n    protected dataIndex?: IndexType = undefined;\r\n    private column: CanvasTableColumn[] = [];\r\n    private orgColum: CanvasTableColumnConf[] = [];\r\n    private cusomFilter?: CustomFilter;\r\n    private customSort?: CustomSort;\r\n    private sortCol?: CanvasTableColumnSort[];\r\n    private groupByCol?:string[];\r\n    private overRowValue?: number;\r\n    private columnResize?: {x:number, col:CanvasTableColumn};\r\n    private touchClick?: {timeout: number, x: number, y: number};\r\n\r\n    private lastCursor: string = \"\";\r\n    private canvasHeight: number = 0;\r\n    private canvasWidth: number = 0;\r\n    protected config: CanvasTableConf;\r\n    constructor (config: CanvasTableConfig | undefined) {\r\n        \r\n        this.config = {\r\n             ...{\r\n                font: \"arial\",\r\n                fontStyle: \"\",\r\n                fontSize: 14,\r\n                fontColor: \"black\",\r\n                headerFont: \"arial\",\r\n                headerFontStyle: \"bold\",\r\n                headerFontSize: 14,\r\n                headerFontColor: \"black\",\r\n                headerBackgroundColor: \"#add8e6\",\r\n                headerDrawSortArrowColor: \"purple\",\r\n                headerDrawSortArrow: true,\r\n                lineColor: \"black\",\r\n                backgroundColor: \"white\",\r\n                howerBackgroundColor: \"#DCDCDC\",\r\n                sepraBackgroundColor: '#ECECEC'\r\n            }, ...config };\r\n    }\r\n\r\n    public isPlanToRedraw(): boolean {\r\n        if (!this.requestAnimationFrame) {\r\n            return false;\r\n        }\r\n        \r\n        return (this.drawconf !== undefined && this.drawconf.fulldraw);\r\n    }\r\n\r\n    public askForReDraw(config?: DrawConfig) {\r\n        if (config === undefined || (this.drawconf !== undefined && this.drawconf.fulldraw)) {\r\n            this.drawconf = { fulldraw: true };\r\n        } else {\r\n          if (this.drawconf === undefined) {\r\n            this.drawconf = {...config, ...{fulldraw :false}};\r\n          } else {\r\n           // this.drawconf = ...this.drawconf, ...config;\r\n          }\r\n        }\r\n\r\n        if (this.requestAnimationFrame) {\r\n            return;\r\n        }\r\n\r\n        this.requestAnimationFrame = requestAnimationFrame(\r\n            () => {\r\n                this.drawCanvas()\r\n            });\r\n    }\r\n\r\n    \r\n    public setFilter(filter?: CustomFilter | null) {\r\n        if (filter === null) {\r\n            filter = undefined;\r\n        }\r\n        if (this.cusomFilter !== filter) {\r\n            this.cusomFilter = filter;\r\n            this.calcIndex();\r\n            this.askForReDraw();\r\n        }\r\n    }\r\n    public setCustomSort(customSort?: CustomSort | null) {\r\n        if (customSort === null) { customSort = undefined; }\r\n        this.customSort = customSort;\r\n        this.sortCol = undefined;\r\n        this.calcIndex();\r\n        this.askForReDraw();\r\n    }\r\n    public setSort(sortCol?: CanvasTableColumnSort[]) {\r\n        this.sortCol = sortCol;\r\n        this.customSort = undefined;\r\n        this.calcIndex();\r\n        this.askForReDraw();\r\n    }\r\n    public setGroupBy(col?:string[]) {\r\n        if (!col) { col = []; }\r\n        this.groupByCol = col;\r\n        this.calcIndex();\r\n        this.askForReDraw();\r\n    }\r\n    public setData(data?:any[]) {\r\n        if (data !== undefined) {\r\n            this.data = data;\r\n        }\r\n        this.calcIndex();\r\n        this.askForReDraw();\r\n    }\r\n    public setColumnVisible(col: number, visible: boolean) {\r\n        if (col < 0 || col >= this.orgColum.length) {\r\n            throw \"out of range\";\r\n        }\r\n\r\n        if (visible && this.orgColum[col].visible === true) { return; }\r\n        if (!visible && !this.orgColum[col].visible) { return; }\r\n        this.orgColum[col].visible = visible;\r\n        this.UpdateColumns(this.orgColum);\r\n    }\r\n    public UpdateColumns(col: CanvasTableColumnConf[]) {\r\n        this.orgColum = col;\r\n        this.column = [];\r\n        for (let i = 0; i < col.length; i++) {\r\n            if (col[i].visible === false) { continue; }\r\n            this.column[this.column.length] = {\r\n                ...{\r\n                    align: Align.left,\r\n                    leftPos: 0,\r\n                    rightPos: 0,\r\n                    width: 50,\r\n                    orginalCol: col[i]\r\n                }, ...col[i]\r\n            };\r\n        }\r\n        this.needToCalc = true;\r\n\r\n        this.resize();\r\n        this.calcColum();\r\n    }\r\n    private calcColum() {\r\n        this.needToCalc = false;\r\n\r\n        let leftPos = 0;\r\n        for (let i = 0; i < this.column.length; i++) {\r\n            this.column[i].leftPos = leftPos;\r\n            leftPos += this.column[i].width * this.r;\r\n            this.column[i].rightPos = leftPos;\r\n        }\r\n\r\n        this.reCalcForScrollView();\r\n    }\r\n    protected setR(r: number) {\r\n        if (this.r === r) { return; }\r\n        this.r = r;\r\n        this.needToCalc = true;    \r\n        this.needToCalcFont = true;\r\n    }\r\n    protected abstract resize(): void;\r\n    protected abstract setCursor(cusor: string): void;\r\n    protected abstract askForExtentedMouseMoveAndMaouseUp():void;\r\n    protected abstract askForNormalMouseMoveAndMaouseUp():void;\r\n    private updateCursor(cursor: string = \"\"): void {\r\n        if (this.lastCursor === cursor) { return; }\r\n        this.lastCursor = cursor;\r\n        this.setCursor(cursor);\r\n    }\r\n\r\n    public expendAll() {\r\n        if (this.dataIndex === undefined) { return; }\r\n        if (this.dataIndex.type === ItemIndexType.GroupItems) {\r\n            this.changeChildExpend(this.dataIndex, true);\r\n            this.reCalcForScrollView();\r\n            this.askForReDraw();\r\n        }\r\n    }\r\n\r\n    public collapseAll() {\r\n        if (this.dataIndex === undefined) { return; }\r\n        if (this.dataIndex.type === ItemIndexType.GroupItems) {\r\n            this.changeChildExpend(this.dataIndex, false);\r\n            this.reCalcForScrollView();\r\n            this.askForReDraw();\r\n        }\r\n    }\r\n\r\n    private resizeColIfNeed(x:number): boolean {\r\n        if (this.columnResize === undefined) { return false; }\r\n        const d = x-this.columnResize.x;\r\n        const col = this.columnResize.col;\r\n        if (d === 0 || col.width + d < 10) { return true; }\r\n        col.width += d;\r\n        this.columnResize.x = x;\r\n        col.orginalCol.width = col.width;\r\n        this.calcColum();\r\n        this.askForReDraw();\r\n        return true;\r\n    }\r\n\r\n    protected clickOnHeader(col:CanvasTableColumn | null){\r\n        if (col) {\r\n            if (this.sortCol && this.sortCol.length == 1 && this.sortCol[0].col == col && this.sortCol[0].sort == Sort.ascending){\r\n                this.setSort([{col: col, sort:Sort.descending}]);\r\n            } else {\r\n                this.setSort([{col: col, sort:Sort.ascending}]);\r\n            }\r\n        }\r\n    }\r\n\r\n    protected wheel(deltaMode: number, deltaX:number, deltaY: number) {\r\n        if (this.scrollView) {\r\n            this.scrollView.onScroll(deltaMode, deltaX, deltaY); \r\n        }\r\n    }\r\n\r\n    protected mouseDown(x: number, y: number) {\r\n        if (this.dataIndex === undefined) { return; }\r\n        if (this.scrollView && this.scrollView.onMouseDown(x, y)) {\r\n            return;\r\n        }\r\n\r\n        if (y <= 18) {\r\n            const colSplit = this.findColSplit(x);\r\n            if (colSplit !== null) {\r\n                this.columnResize = {x:x, col:this.column[colSplit]};\r\n                this.askForExtentedMouseMoveAndMaouseUp();\r\n                return;\r\n            }\r\n            const col = this.findColByPos(x);\r\n            this.clickOnHeader(col);\r\n            \r\n            return;\r\n        }\r\n\r\n        if (this.dataIndex.type === ItemIndexType.GroupItems) {\r\n            const result = this.findRowByPos(y);\r\n            if (result !== null && typeof result === \"object\") {\r\n                result.isExpended = !result.isExpended;\r\n                this.askForReDraw();\r\n                this.reCalcForScrollView();\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected mouseMove(x: number, y: number) {\r\n        if (!this.scrollView) { return; }\r\n        if (this.resizeColIfNeed(x)) {\r\n            return;\r\n        }\r\n\r\n        if (this.scrollView.onMouseMove(x, y)) {\r\n            this.updateCursor();\r\n            this.overRow = undefined;\r\n            return;\r\n        }\r\n\r\n        if (y < 18) {\r\n            this.overRow = undefined;\r\n            if (this.findColSplit(x) === null) {\r\n                this.updateCursor();\r\n            } else {\r\n                this.updateCursor(\"col-resize\");\r\n            }\r\n            return;\r\n        } else {\r\n            this.updateCursor();\r\n            const result = this.findRowByPos(y);\r\n            if (typeof result === \"number\") {\r\n                this.overRow = result;\r\n                return;\r\n            } \r\n            this.overRow = undefined;\r\n        }\r\n    }\r\n    protected mouseUp(x: number, y: number) {\r\n        if (this.columnResize) {\r\n            this.columnResize = undefined;\r\n            this.askForNormalMouseMoveAndMaouseUp();\r\n        }\r\n        if (this.scrollView && this.scrollView.onMouseUp(x, y)) { return; }\r\n    }\r\n    protected mouseMoveExtended(x: number, y: number) {\r\n        if (this.resizeColIfNeed(x)) {\r\n            return;\r\n        }\r\n\r\n        if (this.scrollView && this.scrollView.onExtendedMouseMove(x, y)) { return; }\r\n    }\r\n    protected mouseUpExtended(x: number, y: number) {\r\n        if (this.columnResize) {\r\n            this.columnResize = undefined;\r\n            this.askForNormalMouseMoveAndMaouseUp();\r\n        }\r\n        if (this.scrollView && this.scrollView.onExtendedMouseUp(x, y)) { return; }\r\n    }\r\n    protected mouseLeave() {\r\n        this.overRow = undefined;\r\n        if (this.columnResize === undefined) {\r\n            this.updateCursor();\r\n        }\r\n        if (this.scrollView) {\r\n            this.scrollView.onMouseLeave();\r\n        }\r\n    }\r\n\r\n    protected keydown(keycode: number) {\r\n        if (this.scrollView && this.scrollView.OnKeydown(keycode)) {\r\n            this.overRow = undefined;            \r\n        }\r\n    }\r\n\r\n    protected TouchStart(e:CanvasTableTouchEvent, offsetLeft:number, offsetTop:number) {\r\n        if (this.scrollView && this.scrollView.OnTouchStart(e, offsetLeft, offsetTop)) {\r\n            return;\r\n        }\r\n\r\n        //if (this.dataIndex === undefined) { return; }\r\n\r\n        //if (this.dataIndex.type === ItemIndexType.GroupItems) \r\n        {\r\n            if (e.changedTouches.length === 1) {\r\n                const y = e.changedTouches[0].pageY - offsetTop;\r\n                const x = e.changedTouches[0].pageX - offsetLeft;\r\n                this.touchClick = {timeout: setTimeout(() => {\r\n                    if (y > 18) {                                        \r\n                        const result = this.findRowByPos(y);\r\n                        if (result !== null && typeof result === \"object\") {\r\n                            result.isExpended = !result.isExpended;\r\n                            this.askForReDraw();\r\n                            this.reCalcForScrollView();\r\n                            return;\r\n                        }\r\n                    } else {\r\n                        const colSplit = this.findColSplit(x);\r\n                        if (colSplit !== null) {\r\n                            this.columnResize = {x:x, col:this.column[colSplit]};\r\n                         //   console.log(this.columnResize);\r\n                            return;\r\n                        }\r\n            \r\n                        const col = this.findColByPos(x);\r\n                        this.clickOnHeader(col);\r\n                    }\r\n                }, 250), x: x, y: y};\r\n            } else {\r\n                this.clearTouchClick();\r\n            }\r\n        }\r\n    }\r\n    protected TouchMove(e:CanvasTableTouchEvent, offsetLeft:number, offsetTop:number) {\r\n        const x = e.changedTouches[0].pageX - offsetLeft;                \r\n        if (this.resizeColIfNeed(x)) {\r\n        //    console.log('R');\r\n            return;\r\n        }\r\n//        console.log('-');\r\n        if (this.scrollView) {\r\n            this.scrollView.OnTouchMove(e, offsetLeft, offsetTop);\r\n        }\r\n        if (this.touchClick)\r\n        {\r\n            if (e.changedTouches.length !== 1) {\r\n                this.clearTouchClick();\r\n                return;\r\n            }\r\n\r\n            const y = e.changedTouches[0].pageY - offsetTop;\r\n            if (Math.abs(x - this.touchClick.x) > 4 || Math.abs(y - this.touchClick.y) > 4) {\r\n                this.clearTouchClick();\r\n            }\r\n        }\r\n    }\r\n    protected TouchEnd(e:CanvasTableTouchEvent, offsetLeft:number, offsetTop:number) {\r\n        this.columnResize = undefined;\r\n\r\n        if (this.scrollView) {\r\n            this.scrollView.OnTouchEnd(e);\r\n        }\r\n    }\r\n\r\n    private clearTouchClick() {\r\n        if (this.touchClick) {\r\n            clearTimeout(this.touchClick.timeout);\r\n            this.touchClick = undefined;\r\n        }\r\n    }\r\n\r\n    protected findColSplit(x: number): number | null {\r\n        if (this.scrollView === undefined) { return null; }\r\n        for (let i = 0; i < this.column.length; i++){\r\n            const d = ((-this.scrollView.posX + this.column[i].rightPos) / this.r) - x;\r\n            if (-3 <= d && d <= 3) {\r\n                return i;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    protected findColByPos(x: number): CanvasTableColumn | null {\r\n        if (this.scrollView === undefined) { return null; }\r\n        let pos = this.scrollView.posX / this.r + x;\r\n        let w = 0;\r\n\r\n        for (var i = 0; i < this.column.length; i++) {\r\n            w += this.column[i].width;\r\n            if (w >= pos) {\r\n                return this.column[i];\r\n            }    \r\n        }\r\n\r\n        return null;\r\n    }\r\n    protected findRowByPos(y: number): number | GroupItem | null {\r\n        if (this.dataIndex === undefined || this.scrollView === undefined) { return null; }\r\n        let pos = -this.scrollView.posY / this.r + 18;\r\n        const cellHeight = this.cellHeight;\r\n        const maxHeight = this.canvasHeight / this.r;\r\n\r\n        let find = function(items: GroupItems | Index):number | GroupItem | null {\r\n            let i;\r\n            if (items.type === ItemIndexType.Index) {\r\n                const h = items.list.length * cellHeight;\r\n                if (y > pos + h) {\r\n                    pos += h;\r\n                } \r\n                else {\r\n                    i = Math.trunc((-pos+y) / cellHeight);       \r\n                    pos += i*cellHeight;\r\n                    return i < items.list.length ? items.list[i] : null;\r\n                }\r\n            } else {\r\n                for (i = 0; i < items.list.length; i++) {\r\n                    if (pos < y && y < pos+cellHeight) {\r\n                        return items.list[i];\r\n                    }\r\n                    pos += cellHeight;\r\n                    if (!items.list[i].isExpended) { continue; }\r\n                    let f = find(items.list[i].child);\r\n                    if (f !== null) {\r\n                        return f;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n        \r\n        return find(this.dataIndex);\r\n    }\r\n\r\n    protected set overRow(value: number | undefined){\r\n        if (value != this.overRowValue){\r\n            const temp = this.overRowValue;\r\n            this.overRowValue = value;\r\n            if (value !== undefined && temp !== undefined) { \r\n                this.askForReDraw({ drawOnly: [temp, value] });           \r\n                return; \r\n            }\r\n            \r\n            if (value !== undefined) {\r\n                this.askForReDraw({ drawOnly: [value] });\r\n                return;\r\n            } \r\n\r\n            if (temp !== undefined) {\r\n                this.askForReDraw({ drawOnly: [temp] });\r\n                return;\r\n            } \r\n        }\r\n    }\r\n\r\n    protected calcIndex() {\r\n        if (this.data === undefined) {\r\n            return;\r\n        }\r\n        let index: number[] = []\r\n        if (this.cusomFilter) {\r\n            for (let i = 0; i < this.data.length; i++) {\r\n                if (this.cusomFilter(this.data, this.data[i], this.orgColum)) {\r\n                    index[index.length] = i;\r\n                }\r\n            }\r\n        } else {\r\n            for (let i = 0; i < this.data.length; i++) {\r\n                index[index.length] = i;\r\n            }\r\n        }\r\n\r\n        if (this.customSort) {\r\n            const customSort = this.customSort;\r\n            index.sort((a: number , b: number) => {\r\n                return customSort(this.data, this.data[a], this.data[b]);\r\n            });\r\n        } else {\r\n            const sortCol = this.sortCol;\r\n            if (sortCol && sortCol.length) {\r\n                index.sort((a: number, b: number) => {\r\n                    for (let i = 0; i < sortCol.length; i++) {\r\n                        let d, col = sortCol[i];\r\n                        switch (col.col.field) {\r\n                            case \"__rownum__\":\r\n                                d = a - b;\r\n                                if (d !== 0) { return d * col.sort; }\r\n                                break;\r\n                            default:\r\n                                let da = this.data[a][col.col.field], db = this.data[b][col.col.field];\r\n                                if (da === undefined) {\r\n                                    if (db === undefined) {\r\n                                        continue; \r\n                                    }\r\n                                    return col.sort;\r\n                                }\r\n                                if (db === undefined) {\r\n                                    return -1 * col.sort;\r\n                                }\r\n                                if (typeof da === \"string\" && typeof db === \"string\") {\r\n                                    d = da.localeCompare(db);\r\n                                    if (d !== 0) { return d * col.sort; }\r\n                                    continue;\r\n                                }\r\n                                if (da > db) {\r\n                                    return col.sort;\r\n                                }\r\n                                if (da < db) {\r\n                                    return -1 * col.sort;\r\n                                }\r\n                        }\r\n                    }\r\n                    return 0;\r\n                })\r\n            }\r\n        }\r\n\r\n        if (this.groupByCol && this.groupByCol.length > 0) {\r\n            const groupByCol = this.groupByCol;\r\n            let groupItems: GroupItems = {type:ItemIndexType.GroupItems, list:[]};\r\n                        \r\n            this.group(groupItems, index, 0, groupByCol, this.dataIndex === undefined || this.dataIndex.type === ItemIndexType.Index ? undefined : this.dataIndex );\r\n\r\n            this.dataIndex = groupItems;\r\n        } else {\r\n            this.dataIndex =  { type: ItemIndexType.Index, list: index };\r\n        }\r\n        this.reCalcForScrollView();\r\n    }\r\n    private tryFind(idx: GroupItems | undefined, c: string): GroupItem | undefined {\r\n        if (idx === undefined) {\r\n            return undefined;\r\n        }\r\n        \r\n        for (let i = 0; i < idx.list.length; i++) {\r\n            if (idx.list[i].caption === c) {\r\n                return idx.list[i];\r\n            }\r\n        }\r\n\r\n        return undefined;\r\n    }\r\n    private group(g: GroupItems, index: number[], level: number, groupByCol: string[], old: GroupItems | undefined) {\r\n        let r = new Map<string, number>();\r\n        let p = new Map<GroupItem, number[]>();\r\n\r\n        for (let i=0; i < index.length; i++) {\r\n            const id = index[i];\r\n            let c = String(this.data[id][groupByCol[level]]);\r\n            let d = r.get(c);\r\n            if (d !== undefined) {\r\n                const item = g.list[d];\r\n                if (item.child.type === ItemIndexType.Index) {\r\n                    item.child.list.push(id);\r\n                }\r\n            } else {\r\n                r.set(c, g.list.length);\r\n                const oldGroupItem = this.tryFind(old, c);\r\n                g.list.push({caption: c, isExpended: oldGroupItem === undefined ? false : oldGroupItem.isExpended, child: { type:ItemIndexType.Index, list: [id] }});\r\n            }    \r\n        }\r\n        level++;\r\n        if (groupByCol.length > level) {\r\n            for (let i=0;i<g.list.length;i++) {\r\n                const child = g.list[i].child;\r\n                if (child.type === ItemIndexType.Index) {\r\n                    let item: GroupItems = {  type: ItemIndexType.GroupItems, list: []};\r\n                    const oldGroupItem = this.tryFind(old, g.list[i].caption);\r\n                    this.group(item, child.list, level, groupByCol, oldGroupItem === undefined || oldGroupItem.child.type === ItemIndexType.Index?undefined:oldGroupItem.child);\r\n                    g.list[i].child = item;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private changeChildExpend(g: GroupItems, value: boolean) {\r\n        for (let i=0; i < g.list.length; i++) {\r\n            g.list[i].isExpended = value;\r\n            const child = g.list[i].child;\r\n            if (child.type === ItemIndexType.GroupItems) {\r\n                this.changeChildExpend(child, value);\r\n            }\r\n        }\r\n    }\r\n    protected reCalcForScrollView() {\r\n        if (this.dataIndex === undefined) {return;}\r\n        let w:number | undefined = 1;\r\n        if (this.column) {\r\n            for (let i =0; i < this.column.length; i++) {\r\n                w += this.column[i].width * this.r + 2;\r\n            }        \r\n        } else {\r\n            w = undefined;\r\n        }\r\n        \r\n        let h = 0;\r\n        const cellHeight = this.cellHeight;\r\n        let calc = function( index: Index | GroupItems ) {\r\n            switch(index.type) {\r\n                case ItemIndexType.Index:\r\n                    h += cellHeight * index.list.length;\r\n                    break;\r\n                case ItemIndexType.GroupItems:\r\n                    for (let i = 0; i < index.list.length; i++) {\r\n                        h += cellHeight;\r\n                        if (index.list[i].isExpended) {\r\n                            calc(index.list[i].child);\r\n                        }\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        calc(this.dataIndex);\r\n        if (this.scrollView) {\r\n            this.scrollView.setSize(this.r, this.canvasWidth, this.canvasHeight, w, h * this.r);\r\n        }\r\n    }\r\n    protected setCanvasSize(width:number, height:number):void\r\n    {\r\n        this.canvasWidth = width;\r\n        this.canvasHeight = height;\r\n        this.reCalcForScrollView();\r\n    }\r\n    protected doReize(width:number, height:number) {\r\n        this.setCanvasSize(width * this.r, height * this.r);\r\n    }\r\n\r\n    protected drawCanvas() {\r\n        if (!this.scrollView || !this.context || !this.dataIndex) {\r\n            return;\r\n        }\r\n\r\n        if (this.needToCalc){\r\n            this.calcColum();\r\n        }\r\n\r\n        this.context.font = this.config.fontStyle + \" \" + this.config.fontSize * this.r + \"px \" + this.config.font;\r\n\r\n        if (this.needToCalcFont) {\r\n            this.minFontWidth = this.context.measureText('i').width;\r\n            this.maxFontWidth = this.context.measureText('Æ').width;    \r\n        }\r\n        if (this.drawconf !== undefined && this.drawconf.fulldraw) {\r\n            this.drawconf = undefined;\r\n        }\r\n        const drawConf = this.drawconf;\r\n        this.drawconf = undefined;\r\n\r\n        this.requestAnimationFrame = undefined;\r\n        \r\n        if (this.scrollView.beforeDraw()) {\r\n            this.askForReDraw();\r\n        }\r\n\r\n        const headderHeight = 18 * this.r;\r\n        const offsetLeft = 5 * this.r;\r\n        if (drawConf === undefined) {\r\n            this.context.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\r\n        }\r\n\r\n        this.context.fillStyle = this.config.fontColor;\r\n        this.context.strokeStyle = this.config.lineColor;\r\n        const colStart  = 0;\r\n        const colEnd  = this.column.length;\r\n\r\n        const height = this.cellHeight * this.r;\r\n        let index = this.dataIndex;\r\n        let pos: number, i, maxPos;\r\n        switch(index.type) {\r\n            case ItemIndexType.Index:\r\n                maxPos = this.canvasHeight + this.cellHeight + 5 * this.r;\r\n                i = Math.floor(this.scrollView.posY / (height));\r\n                pos = (-this.scrollView.posY + (i + 1) * height);\r\n                pos += 14 * this.r;\r\n                while (pos < maxPos) {\r\n                    if (i < index.list.length) {\r\n                        this.drawRowItem(index.list[i], i, pos, height, offsetLeft, colStart, colEnd, drawConf);\r\n                    }\r\n                    \r\n                    pos += height;\r\n                    i++;\r\n                }\r\n\r\n                this.context.beginPath();\r\n                for (let col = colStart; col < colEnd; col++) {\r\n                    const rightPos = -this.scrollView.posX + this.column[col].rightPos;\r\n                    this.context.moveTo(rightPos, headderHeight)\r\n                    this.context.lineTo(rightPos, this.canvasHeight);\r\n                }\r\n                this.context.stroke();\r\n                break;\r\n            case ItemIndexType.GroupItems:\r\n                pos = -this.scrollView.posY;\r\n                maxPos = this.canvasHeight + this.cellHeight + 5 * this.r;\r\n                pos += 14 * this.r + height;\r\n                i = 0;\r\n                while (pos < maxPos && index.list.length > i) {\r\n                    const item = index.list[i];\r\n                    pos = this.drawGroupItem(1, item, pos, height, maxPos, offsetLeft, colStart, colEnd, drawConf);\r\n                    i++;\r\n                }\r\n                break;\r\n        }\r\n        \r\n        // Headder\r\n        pos = 14 * this.r;\r\n        this.context.font = this.config.headerFontStyle + \" \" + this.config.headerFontSize * this.r + \"px \" + this.config.headerFont;\r\n        this.context.fillStyle = this.config.headerFontColor;\r\n        this.context.clearRect(0, 0, this.canvasWidth, headderHeight);\r\n        this.context.beginPath();\r\n        for (let col = colStart; col < colEnd; col++) {\r\n            const rightPos = -this.scrollView.posX + this.column[col].rightPos;\r\n            this.context.moveTo(rightPos, 0)\r\n            this.context.lineTo(rightPos, headderHeight);\r\n        }\r\n        this.context.stroke();\r\n\r\n        this.context.textAlign = 'left';\r\n        for (let col = colStart; col < colEnd; col++) {\r\n            let needClip: boolean;\r\n            const colItem = this.column[col];\r\n            const colWidth = this.column[col].width * this.r - offsetLeft * 2;\r\n            const data = this.column[col].header;\r\n            if (colWidth > data.length*this.maxFontWidth) {\r\n                needClip = false;\r\n            } else if (colWidth < data.length*this.minFontWidth) {\r\n                needClip = true;\r\n            } else {\r\n                needClip = colWidth < this.context.measureText(data).width;\r\n            }\r\n\r\n            this.context.fillStyle = this.config.headerBackgroundColor;\r\n            if (needClip) {\r\n                this.context.fillRect( -this.scrollView.posX + colItem.leftPos + 1, pos - height+4*this.r+1, colItem.width * this.r - 1 * 2, height-3);\r\n                this.context.save();\r\n                this.context.beginPath();\r\n                this.context.rect( -this.scrollView.posX + colItem.leftPos + offsetLeft, pos - height, colItem.width * this.r - offsetLeft * 2, height);\r\n                this.context.clip();\r\n                this.context.fillStyle = this.config.headerFontColor;\r\n                this.context.fillText(data, -this.scrollView.posX + colItem.leftPos + offsetLeft, pos);\r\n                this.context.restore();\r\n            } else {\r\n                this.context.fillRect( -this.scrollView.posX + colItem.leftPos + 1, pos - height+4*this.r+1, colItem.width * this.r - 1 * 2, height-3);\r\n                this.context.fillStyle = this.config.headerFontColor;\r\n                this.context.fillText(data,  -this.scrollView.posX + colItem.leftPos + offsetLeft, pos);\r\n            }\r\n\r\n            if (this.config.headerDrawSortArrow) {\r\n                var sort:Sort|undefined = undefined;\r\n                if (this.sortCol){\r\n                    for (let i = 0; i < this.sortCol.length; i++){\r\n                        if (this.sortCol[i].col === this.column[col]){\r\n                            sort = this.sortCol[i].sort;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                if (sort) {\r\n                    this.context.fillStyle = this.config.headerDrawSortArrowColor;\r\n                    const startX =  -this.scrollView.posX + this.column[col].rightPos;\r\n                    if (sort === Sort.ascending) { \r\n                        this.context.beginPath();\r\n                        this.context.moveTo(startX - 12 * this.r, 5 * this.r);\r\n                        this.context.lineTo(startX - 4 * this.r, 5 * this.r);\r\n                        this.context.lineTo(startX - 8 * this.r, 14 * this.r);\r\n                        this.context.fill();\r\n                    } else {\r\n                        this.context.beginPath();\r\n                        this.context.moveTo(startX - 8 * this.r, 5 * this.r);\r\n                        this.context.lineTo(startX - 12 * this.r, 14 * this.r);\r\n                        this.context.lineTo(startX - 4 * this.r, 14 * this.r);\r\n                        this.context.fill();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.context.beginPath();\r\n        this.context.moveTo(0, pos + 4 * this.r);\r\n        this.context.lineTo(this.canvasWidth, pos + 4 * this.r);\r\n        this.context.stroke();\r\n                \r\n        this.scrollView.draw();        \r\n    }\r\n\r\n    private drawGroupItem(level:number, groupItem: GroupItem, pos: number, height: number, maxPos: number, offsetLeft: number, colStart: number, colEnd: number, drawConf: DrawConfig|undefined) {\r\n        if (!this.scrollView || !this.context) {\r\n            return 0;\r\n        }\r\n        if (pos > 0 && drawConf === undefined) {\r\n            this.context.textAlign = 'left';\r\n            this.context.fillText(groupItem.caption + ' (' + groupItem.child.list.length + ')',  -this.scrollView.posX + 10 * level * this.r, pos);\r\n        }\r\n        pos += height;\r\n        if (groupItem.isExpended) {\r\n            const child = groupItem.child;\r\n            let i;\r\n            if (child.type === ItemIndexType.Index) {\r\n                if (0 > pos + child.list.length * height) {\r\n                    pos += child.list.length * height;\r\n                } else {\r\n                    i = 0;\r\n                    if (pos < -height) {\r\n                        i = Math.trunc(-pos / height);\r\n                        pos += i * height;\r\n                    }\r\n                    if (drawConf === undefined) {\r\n                        this.context.strokeStyle = this.config.lineColor;\r\n                        this.context.beginPath();            \r\n                        this.context.moveTo(0, pos+ 4*this.r+1 -height);\r\n                        this.context.lineTo(this.column[this.column.length-1].rightPos, pos + 4*this.r+1-height);\r\n                        this.context.stroke();\r\n                    }\r\n                    const startPos = pos;\r\n                    for (; i < child.list.length && pos < maxPos; i++) {\r\n                        const item = child.list[i];\r\n                        if (pos > 0) {\r\n                            this.drawRowItem(item, i, pos, height, offsetLeft, colStart, colEnd, drawConf);\r\n                        }\r\n                        pos += height;\r\n                    }    \r\n                    for (var col = colStart; col < colEnd; col++) {\r\n                        const colItem = this.column[col];\r\n                        this.context.beginPath();            \r\n                        this.context.moveTo( -this.scrollView.posX + colItem.rightPos, startPos+ 4*this.r+1-height);\r\n                        this.context.lineTo( -this.scrollView.posX + colItem.rightPos, pos+ 4*this.r+1-height);\r\n                        this.context.stroke();\r\n                    }\r\n            \r\n                }\r\n            } else {\r\n                for (i = 0; i < child.list.length && pos < maxPos; i++) {\r\n                    const item = child.list[i];\r\n                    pos = this.drawGroupItem(level + 1, item, pos, height, maxPos, offsetLeft, colStart, colEnd, drawConf);\r\n                }\r\n            }\r\n        }\r\n        return pos;\r\n\r\n    }\r\n    private drawRowItem(indexId: number, i: number, pos: number, height: number, offsetLeft: number, colStart:number, colEnd:number, drawConf: DrawConfig|undefined) {\r\n        if (!this.scrollView || !this.context) { return 0; }\r\n        if (drawConf !== undefined && drawConf.drawOnly !== undefined){\r\n            let found = false;\r\n            for (let i=0;i <drawConf.drawOnly.length; i++){\r\n                if (drawConf.drawOnly[i] === indexId) {\r\n                    found = true;\r\n                    break;\r\n                }\r\n            }\r\n            \r\n            if (!found) {\r\n                return;\r\n            } else {\r\n                this.context.clearRect(0, pos - height + 4*this.r+1, this.canvasWidth, height-2);\r\n            }\r\n        }\r\n        for (let col = colStart; col < colEnd; col++) {\r\n            const colItem = this.column[col];\r\n            let data: string;\r\n            switch (colItem.field) {\r\n                case \"__rownum__\":\r\n                    data = indexId.toString();\r\n                    break;\r\n                case \"__idxnum__\":\r\n                    data = i.toString();\r\n                    break;\r\n                default:\r\n                    data = this.data[indexId][colItem.field];\r\n            }\r\n\r\n            if (colItem.customData) {\r\n                data = colItem.customData(this, data, this.data[indexId], this.data, indexId, colItem);\r\n            }\r\n\r\n            if (colItem.renderer) {\r\n                const left =  -this.scrollView.posX + colItem.leftPos + 1;\r\n                const top = pos - height + 4 * this.r + 1;\r\n                const width = colItem.width * this.r - 2;\r\n                const h = height - 2;\r\n                this.context.save();\r\n                this.context.beginPath();\r\n                this.context.rect(left, top, width, h);\r\n                this.context.clip();\r\n                try {\r\n                    colItem.renderer(this, this.context, indexId, this.orgColum[col],\r\n                        left, top, left + width, top + h, width, h, this.r,\r\n                        data, this.data[indexId], this.data);\r\n                } catch (e) {\r\n                    console.log(\"CanvasTable renderer\", colItem.header, e);\r\n                }\r\n                this.context.restore();\r\n                continue;\r\n            }\r\n            \r\n            let needClip: boolean;\r\n            const colWidth = colItem.width * this.r - offsetLeft * 2;\r\n            if (data === null) {\r\n                return;\r\n            }\r\n            if (colWidth > data.length*this.maxFontWidth) {\r\n                needClip = false;\r\n            } else if (colWidth < data.length*this.minFontWidth) {\r\n                needClip = true;\r\n            } else {\r\n                needClip = colWidth < this.context.measureText(data).width;\r\n            }\r\n\r\n            let x;\r\n            switch (colItem.align) {\r\n                case Align.left:\r\n                default:\r\n                    x = colItem.leftPos + offsetLeft;\r\n                    if (this.context.textAlign !== 'left') {\r\n                        this.context.textAlign = 'left';\r\n                    }\r\n                    break;\r\n                case Align.right:\r\n                    x = colItem.rightPos - offsetLeft;\r\n                    if (this.context.textAlign !== 'right') {\r\n                        this.context.textAlign = 'right';\r\n                    }\r\n                    break;\r\n                case Align.center:\r\n                    x = colItem.leftPos + colItem.width * this.r * 0.5 - offsetLeft;\r\n                    if (this.context.textAlign !== 'center') {\r\n                        this.context.textAlign = 'center';\r\n                    }\r\n                    break;\r\n            }\r\n\r\n            if (this.overRowValue === indexId) {\r\n                this.context.fillStyle = this.config.howerBackgroundColor;\r\n            } else {\r\n                this.context.fillStyle = i % 2 === 0 ?  this.config.sepraBackgroundColor : this.config.backgroundColor ;\r\n            }\r\n\r\n            if (needClip) {\r\n                this.context.fillRect( -this.scrollView.posX + colItem.leftPos + 1, pos - height+4*this.r+1, colItem.width * this.r - 1 * 2, height-3);\r\n                this.context.save();\r\n                this.context.beginPath();\r\n                this.context.rect( -this.scrollView.posX + colItem.leftPos + offsetLeft, pos - height, colItem.width * this.r - offsetLeft * 2, height);\r\n                this.context.clip();\r\n                this.context.fillStyle = this.config.fontColor;\r\n                this.context.fillText(data, -this.scrollView.posX + x, pos);\r\n                this.context.restore();\r\n            } else {\r\n                this.context.fillRect( -this.scrollView.posX + colItem.leftPos + 1, pos - height+4*this.r+1, colItem.width * this.r - 1 * 2, height-3);\r\n                this.context.fillStyle = this.config.fontColor;\r\n                this.context.fillText(data,  -this.scrollView.posX + x, pos);\r\n            }\r\n        }\r\n        if (drawConf === undefined) {\r\n            this.context.beginPath();            \r\n            this.context.moveTo(0, pos + 4 * this.r);\r\n            this.context.lineTo(this.column[this.column.length-1].rightPos, pos+ 4*this.r);\r\n            this.context.stroke();\r\n        }\r\n    }\r\n}","import { CanvasTableTouchEvent } from \"./CanvasTableTouchEvent\";\r\n\r\nexport enum OffscreenCanvasMesssageType { \r\n    create = 0, \r\n    resize = 1,\r\n    expendAll = 2, collapseAll = 3, setGroupBy = 4, \r\n    scroll = 10, \r\n    mouseDown = 20, mouseMove = 21, mouseUp = 22, mouseLeave = 23, mouseMoveExtended = 24, mouseUpExtended = 25,\r\n    TouchStart = 30, TouchMove = 31, TouchEnd = 32,\r\n    keyDown = 40,\r\n    askForExtentedMouseMoveAndMaouseUp = 100, askForNormalMouseMoveAndMaouseUp = 101, setCursor = 102\r\n    }\r\n\r\ninterface OffscreenCanvasMesssageParnet {\r\n    type:OffscreenCanvasMesssageType,\r\n    mthbCanvasTable:number\r\n}\r\n\r\ninterface OffscreenCanvasMessageCreate extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.create,\r\n    offscreen: OffscreenCanvas,\r\n    width: number,\r\n    height: number,\r\n    r: number\r\n}\r\n\r\ninterface OffscreenCanvasMessageResize extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.resize,\r\n    width: number,\r\n    height: number,\r\n    r: number\r\n}\r\n\r\n\r\ninterface OffscreenCanvasMessageFunctions extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.expendAll \r\n        | OffscreenCanvasMesssageType.collapseAll \r\n        | OffscreenCanvasMesssageType.askForExtentedMouseMoveAndMaouseUp \r\n        | OffscreenCanvasMesssageType.askForNormalMouseMoveAndMaouseUp\r\n}\r\n\r\ninterface OffscreenCanvasMessageScroll extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.scroll,\r\n    deltaMode: number,\r\n    deltaX: number,\r\n    deltaY: number\r\n}\r\n\r\ninterface OffscreenCanvasMessageMouse extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.mouseDown | OffscreenCanvasMesssageType.mouseMove | OffscreenCanvasMesssageType.mouseUp\r\n        | OffscreenCanvasMesssageType.mouseMoveExtended | OffscreenCanvasMesssageType.mouseUpExtended,\r\n    x: number,\r\n    y: number\r\n}\r\n\r\ninterface OffscreenCanvasMessageMouseLeave extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.mouseLeave\r\n}\r\ninterface OffscreenCanvasMessageKeyDown extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.keyDown,\r\n    keycode: number\r\n}\r\ninterface OffscreenCanvasMesssageTouch extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.TouchStart | \r\n    OffscreenCanvasMesssageType.TouchMove |\r\n    OffscreenCanvasMesssageType.TouchEnd,\r\n    event: CanvasTableTouchEvent, \r\n    offsetLeft: number, \r\n    offsetTop: number\r\n}\r\n\r\ninterface OffscreenCanvasMessageGroupBy extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.setGroupBy,\r\n    groupBy?: string[]\r\n}\r\n\r\ninterface OffscreenCanvasMessageSetCursor extends OffscreenCanvasMesssageParnet {\r\n    type: OffscreenCanvasMesssageType.setCursor,\r\n    cursor: string\r\n}\r\n\r\n\r\n\r\nexport type OffscreenCanvasMesssage = \r\n      OffscreenCanvasMessageScroll \r\n    | OffscreenCanvasMessageCreate\r\n    | OffscreenCanvasMessageResize\r\n    | OffscreenCanvasMessageSetCursor\r\n    | OffscreenCanvasMessageFunctions\r\n    | OffscreenCanvasMessageGroupBy\r\n    | OffscreenCanvasMessageMouse\r\n    | OffscreenCanvasMessageMouseLeave\r\n    | OffscreenCanvasMessageKeyDown\r\n    | OffscreenCanvasMesssageTouch;","import { Drawable } from \"./Drawable\";\r\nimport { CircularBuffer } from './CircularBuffer';\r\nimport { CanvasContext2D, CanvasColor } from \"./CanvasContext2D\";\r\nimport { CanvasTableTouchEvent } from './CanvasTableTouchEvent';\r\n\r\ndeclare function setTimeout(callback: (...args: any[]) => void, ms: number, ...args: any[]): number;\r\n\r\ninterface MouseMove {\r\n    x: number;\r\n    y: number;\r\n    time: Date;\r\n}\r\n\r\nexport interface ScrollViewConfig {\r\n   buttonHoverColor?: CanvasColor,\r\n   buttonColor?: CanvasColor,\r\n   backgroundColor?: CanvasColor,\r\n}\r\n\r\ninterface ScrollViewConf {\r\n    buttonHoverColor: CanvasColor,\r\n    buttonColor: CanvasColor,\r\n    backgroundColor: CanvasColor,\r\n }\r\n\r\nexport class ScrollView {\r\n    private drawable: Drawable;\r\n    private askForExtentedMouseMoveAndMaouseUp: () => void;\r\n    private askForNormalMouseMoveAndMaouseUp: () => void;\r\n    private canvasWidth: number = -1;\r\n    private canvasHeight: number = -1;\r\n    private context: CanvasContext2D;\r\n    private height?: number;\r\n    private width?: number;\r\n    private r: number = 1;\r\n    private timeout?: number;\r\n\r\n    private hasScrollBarY: boolean = false;\r\n    private scrollBarThumbDownY: boolean = false;\r\n    private isOverScrollUpY: boolean = false;\r\n    private isOverScrollDownY: boolean = false;\r\n    private isOverScollThumbY: boolean = false;\r\n    private posYvalue: number = 0;\r\n    private scrollBarThumbMinY: number = -1;\r\n    private scrollBarThumbMaxY: number = -1;\r\n    private scrollBarPosMaxY: number = -1;\r\n    private pageY: number = -1;\r\n    private touchStartY: number = -1;\r\n\r\n    private hasScrollBarX: boolean = false;\r\n    private scrollBarThumbDownX: boolean = false;\r\n    private isOverScrollUpX: boolean = false;\r\n    private isOverScrollDownX: boolean = false;\r\n    private isOverScollThumbX: boolean = false;\r\n    private posXvalue: number = 0;\r\n    private scrollBarThumbMinX: number = -1;\r\n    private scrollBarThumbMaxX: number = -1;\r\n    private scrollBarPosMaxX: number = -1;\r\n    private pageX: number = -1;\r\n    private touchStartX: number = 1;\r\n\r\n    private lastmove: CircularBuffer<MouseMove>;\r\n\r\n    private scrollbarSize = 20;\r\n    private cellHeight = 20;\r\n    private run: boolean = false;\r\n    private runXOrY: boolean = false;\r\n    private runStart: number = -1;\r\n    private speed: number = 1;\r\n    private scrollViewConfig: ScrollViewConf;\r\n\r\n\r\n    public constructor(context: CanvasContext2D, drawable: Drawable, config:ScrollViewConfig|undefined, askForExtentedMouseMoveAndMaouseUp: () => void, askForNormalMouseMoveAndMaouseUp: () => void) {\r\n        this.askForExtentedMouseMoveAndMaouseUp = askForExtentedMouseMoveAndMaouseUp;\r\n        this.askForNormalMouseMoveAndMaouseUp = askForNormalMouseMoveAndMaouseUp;\r\n        this.drawable = drawable;\r\n        this.lastmove = new CircularBuffer<MouseMove>(100, true);\r\n        this.context = context;\r\n        this.scrollViewConfig = {\r\n             ...{\r\n                buttonHoverColor: \"#808080\",\r\n                buttonColor: \"#b0b0b0\",\r\n                backgroundColor: \"#f0f0f0\",\r\n            },  ...config };\r\n    }\r\n\r\n    get posY(): number {\r\n        return this.posYvalue;\r\n    }\r\n    set posY(value: number) {\r\n        if (!this.hasScrollBarY) {\r\n            value = 0;\r\n        }\r\n        \r\n        if (value <= 0) {\r\n            value = 0;\r\n        }\r\n        else {\r\n            if (value > this.scrollBarPosMaxY) {\r\n                value = this.scrollBarPosMaxY;\r\n            }\r\n        }\r\n\r\n        if (this.posYvalue != value) {\r\n            this.posYvalue = value;\r\n            this.drawable.askForReDraw();\r\n        }\r\n    }\r\n\r\n    get posX(): number {\r\n        return this.posXvalue;\r\n    }\r\n    set posX(value: number) {\r\n        if (!this.hasScrollBarX) {\r\n            value = 0;\r\n        }\r\n        \r\n        if (value <= 0) {\r\n            value = 0;\r\n        }\r\n        else {\r\n            if (value > this.scrollBarPosMaxX) {\r\n                value = this.scrollBarPosMaxX;\r\n            }\r\n        }\r\n\r\n        if (this.posXvalue != value) {\r\n            this.posXvalue = value;\r\n            this.drawable.askForReDraw();\r\n        }\r\n    }\r\n\r\n    public setSize(r:number, canvasWidth:number, canvasHeight:number, width?: number, height?: number) {        \r\n        this.canvasHeight = canvasHeight;\r\n        this.canvasWidth = canvasWidth;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.r = r;\r\n\r\n        if (this.height === undefined || this.width === undefined) {\r\n            this.hasScrollBarX = false;\r\n            this.hasScrollBarY = false;\r\n            this.scrollBarPosMaxX = 0;\r\n            this.scrollBarPosMaxY = 0;\r\n            return;\r\n        }\r\n\r\n        if ((this.height / (this.canvasHeight - (18 + this.scrollbarSize) * this.r) > 1) && (this.width / (this.canvasWidth - this.scrollbarSize * this.r) > 1)) {\r\n            // has X and Y\r\n            this.pageY = this.height / (this.canvasHeight - (18 + this.scrollbarSize) * this.r);\r\n            if (this.pageY < 1) {\r\n                this.hasScrollBarY = false;\r\n                this.scrollBarPosMaxY = 0;            \r\n            } else {\r\n                this.hasScrollBarY = true;\r\n                this.scrollBarPosMaxY  = this.height - (this.canvasHeight - (18 + this.scrollbarSize) * this.r);        \r\n            }\r\n\r\n            this.pageX = this.width / (this.canvasWidth - this.scrollbarSize * this.r);\r\n            if (this.pageX < 1) {\r\n                this.hasScrollBarX = false;\r\n                this.scrollBarPosMaxX = 0;          \r\n            } else {\r\n                this.hasScrollBarX = true;\r\n                this.scrollBarPosMaxX  = this.width - (this.canvasWidth - this.scrollbarSize * this.r);        \r\n            }\r\n        } else {\r\n            // has x or Y\r\n            this.pageY = this.height / (this.canvasHeight - 18 * this.r);\r\n            if (this.pageY < 1) {\r\n                this.hasScrollBarY = false;\r\n                this.scrollBarPosMaxY = 0;            \r\n            } else {\r\n                this.hasScrollBarY = true;\r\n                this.scrollBarPosMaxY  = this.height - (this.canvasHeight - 18 * this.r);        \r\n            }\r\n\r\n            this.pageX = this.width / this.canvasWidth;\r\n            if (this.pageX < 1) {\r\n                this.hasScrollBarX = false;\r\n                this.scrollBarPosMaxX = 0;            \r\n            } else {\r\n                this.hasScrollBarX = true;\r\n                this.scrollBarPosMaxX  = this.width - this.canvasWidth;        \r\n            }\r\n        }\r\n\r\n        if (this.posY > this.scrollBarPosMaxY) { this.posY = this.scrollBarPosMaxY; }\r\n        if (this.posX > this.scrollBarPosMaxX) { this.posX = this.scrollBarPosMaxX; }\r\n    }\r\n\r\n    public beforeDraw(): boolean{\r\n        if (this.run) {\r\n            if (this.runStart === -1) {\r\n                if (this.runXOrY){\r\n                    this.posY -= (this.speed * this.r);\r\n                } else {\r\n                    this.posX -= (this.speed * this.r);\r\n                }\r\n                return true;\r\n            }\r\n            const time = (new Date()).getTime() - this.runStart;\r\n            if (time < 1500) {\r\n                if (this.runXOrY) {\r\n                    this.posY -= (this.speed * this.r) * (1-time/1500);\r\n                } else {\r\n                    this.posX -= (this.speed * this.r) * (1-time/1500);\r\n                }\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    public OnKeydown(keyCode: number): boolean {\r\n        switch (keyCode) {\r\n            case 33: // pagedown\r\n                this.posY -= this.canvasHeight;\r\n                return true;\r\n            case 34: // pageup\r\n                this.posY += this.canvasHeight;\r\n                return true;\r\n            case 38: // up\r\n                this.posY -= this.cellHeight * this.r;\r\n                return true;\r\n            case 40: // down\r\n                this.posY += this.cellHeight * this.r;\r\n                return true;\r\n            default:\r\n                return false;\r\n        }        \r\n    }\r\n    public OnTouchStart(e:CanvasTableTouchEvent, offsetLeft: number, offsetTop:number):boolean {\r\n        this.run = false;\r\n        this.lastmove.clear();\r\n        const y = e.changedTouches[0].pageY - offsetTop;\r\n        const x = e.changedTouches[0].pageX - offsetLeft;\r\n        if (this.scrollClick(x, y, true)) {            \r\n            return true;\r\n        }\r\n        this.touchStartY = e.changedTouches[0].pageY;\r\n        this.touchStartX = e.changedTouches[0].pageX;\r\n        this.lastmove.push({ x: e.changedTouches[0].pageX, y: e.changedTouches[0].pageY, time: new Date() });\r\n\r\n        return false;\r\n    }\r\n    public OnTouchMove(e:CanvasTableTouchEvent, offsetLeft: number, offsetTop:number) {       \r\n        this.run = false;\r\n        if (this.scrollBarThumbDownY) {\r\n            const y = e.changedTouches[0].pageY - offsetTop;\r\n            this.posY = this.scrollBarPosMaxY * ((y - 20) / (this.canvasHeight / this.r - 20 * 2));\r\n            return;\r\n        }\r\n\r\n        if (this.scrollBarThumbDownX) {\r\n            const x = e.changedTouches[0].pageX - offsetLeft;\r\n            this.posX = this.scrollBarPosMaxX * (x / (this.canvasWidth / this.r - 20 * 2));\r\n            return;\r\n        }\r\n\r\n        if (this.lastmove.size() === 0) {\r\n            return;\r\n        }\r\n\r\n        this.lastmove.push({ x: e.changedTouches[0].pageX, y: e.changedTouches[0].pageY, time: new Date() });\r\n        this.posY -=  (e.changedTouches[0].pageY - this.touchStartY) * this.r;\r\n        this.posX -=  (e.changedTouches[0].pageX - this.touchStartX) * this.r;\r\n        \r\n        this.touchStartY = e.changedTouches[0].pageY;\r\n        this.touchStartX = e.changedTouches[0].pageX;\r\n    }\r\n    public OnTouchEnd(e:CanvasTableTouchEvent) {\r\n        if (e.touches.length === 0) {\r\n            let needToReDraw = false;    \r\n            if (this.isOverScollThumbY) {\r\n                this.isOverScollThumbY = false;\r\n                needToReDraw = true;\r\n            }\r\n            if (this.isOverScrollUpY) {\r\n                this.isOverScrollUpY = false;\r\n                needToReDraw = true;\r\n            }\r\n            if (this.isOverScrollDownY) {\r\n                this.isOverScrollDownY = false;\r\n                needToReDraw = true;\r\n            }\r\n            if (this.isOverScollThumbX) {\r\n                this.isOverScollThumbX = false;\r\n                needToReDraw = true;\r\n            }\r\n            if (this.isOverScrollUpX) {\r\n                this.isOverScrollUpX = false;\r\n                needToReDraw = true;\r\n            }\r\n            if (this.isOverScrollDownX) {\r\n                this.isOverScrollDownX = false;\r\n                needToReDraw = true;\r\n            }\r\n            if (needToReDraw) {\r\n                this.drawMe();\r\n            }\r\n            this.scrollBarThumbDownY = false;\r\n            this.scrollBarThumbDownX = false;\r\n            if (this.run || this.timeout) {\r\n                clearTimeout(this.timeout);\r\n                this.timeout = undefined;\r\n                this.run = false;     \r\n            }       \r\n        }\r\n\r\n        const list = this.lastmove.export();\r\n        if (list.length > 2) {\r\n            var i = list.length - 2;\r\n            for (; i >= 0 && (list[list.length - 1].time.getTime() - list[i].time.getTime()) < 1000; i--) { }\r\n            if (i < 0) { i = 0;}\r\n            const time = list[list.length-1].time.getTime() - list[i].time.getTime();\r\n            const speedY = this.r * (list[list.length-1].y - list[i].y) / time;\r\n\r\n            if (Math.abs(speedY) > 1)\r\n            {\r\n                this.speed = speedY * 10;\r\n                this.runXOrY = true;\r\n                this.run = true;\r\n                this.runStart = (new Date()).getTime();\r\n                this.drawable.askForReDraw();\r\n                return;\r\n            }\r\n\r\n            const speedX = this.r * (list[list.length-1].x - list[i].x) / time;\r\n\r\n            if (Math.abs(speedX) > 1)\r\n            {\r\n                this.speed = speedX * 10;\r\n                this.runXOrY = false;\r\n                this.run = true;\r\n                this.runStart = (new Date()).getTime();\r\n                this.drawable.askForReDraw();\r\n                return;\r\n            }\r\n        }\r\n    }\r\n    public onScroll = (deltaMode:number, deltaX: number, deltaY:number) => {\r\n        switch (deltaMode) {\r\n            case 0: // DOM_DELTA_PIXEL\t0x00\tThe delta values are specified in pixels.\r\n                this.posY += deltaY;\r\n                this.posX += deltaX;\r\n                break;\r\n            case 1: // DOM_DELTA_LINE\t0x01\tThe delta values are specified in lines.\r\n                this.posY += deltaY * this.cellHeight * this.r;\r\n                this.posX += deltaX * this.cellHeight * this.r;\r\n                break;\r\n            case 2: // DOM_DELTA_PAGE\t0x02\tThe delta values are specified in pages.\r\n                this.posY += deltaY * this.canvasHeight * this.r;\r\n                this.posX += deltaX * this.canvasWidth * this.r;\r\n                break;\r\n            default:\r\n                // uups\r\n                return;\r\n        }\r\n\r\n        this.fixPos();\r\n    }\r\n    public onMouseLeave() {\r\n        var needToReDraw = false;\r\n        if (this.isOverScollThumbY && !this.scrollBarThumbDownY) {\r\n            this.isOverScollThumbY = false;\r\n            needToReDraw = true;\r\n        }\r\n        if (this.isOverScrollUpY) {\r\n            this.isOverScrollUpY = false;\r\n            needToReDraw = true;\r\n        }\r\n        if (this.isOverScrollDownY) {\r\n            this.isOverScrollDownY = false;\r\n            needToReDraw = true;\r\n        }\r\n\r\n        if (this.isOverScollThumbX && !this.scrollBarThumbDownX) {\r\n            this.isOverScollThumbX = false;\r\n            needToReDraw = true;\r\n        }\r\n        if (this.isOverScrollUpX) {\r\n            this.isOverScrollUpX = false;\r\n            needToReDraw = true;\r\n        }\r\n        if (this.isOverScrollDownX) {\r\n            this.isOverScrollDownX = false;\r\n            needToReDraw = true;\r\n        }\r\n\r\n        if (needToReDraw) {\r\n            this.drawMe();\r\n        }\r\n    }\r\n    public onExtendedMouseUp(x: number, y: number): boolean{\r\n        this.askForNormalMouseMoveAndMaouseUp.call(this.drawable);\r\n\r\n        this.scrollBarThumbDownY = false;\r\n        this.scrollBarThumbDownX = false;\r\n        if (this.isOverScollThumbY && (\r\n            x > this.canvasWidth / this.r\r\n            || (x < this.canvasWidth / this.r - this.scrollbarSize) \r\n            || (this.scrollBarThumbMinY > y)\r\n            || (y > this.scrollBarThumbMaxY) \r\n            )) {\r\n            this.isOverScollThumbY = false;\r\n            this.drawMe();\r\n        }\r\n\r\n        if (this.isOverScollThumbX && (\r\n            y > this.canvasHeight / this.r\r\n            || (y < this.canvasHeight / this.r - this.scrollbarSize) \r\n            || (this.scrollBarThumbMinX > x)\r\n            || (x > this.scrollBarThumbMaxX) \r\n            )) {\r\n            this.isOverScollThumbY = false;\r\n            this.drawMe();\r\n        }\r\n\r\n        return false;\r\n    }\r\n    public onExtendedMouseMove(x: number, y: number): boolean {\r\n        if (this.scrollBarThumbDownY) {\r\n            this.posY = this.scrollBarPosMaxY * ((y - 20) / (this.canvasHeight / this.r - 20 * 2));\r\n        }\r\n        if (this.scrollBarThumbDownX) {\r\n            this.posX = this.scrollBarPosMaxX * (x / (this.canvasWidth / this.r - 20 * 2));\r\n        }\r\n        return true;\r\n    }\r\n    public onMouseDown(x: number, y: number): boolean {\r\n        return this.scrollClick(x, y, false);\r\n    }\r\n    public onMouseMove(x: number, y: number): boolean {\r\n        if (!this.hasScrollBarY && !this.hasScrollBarX) { return false; }\r\n\r\n        const canvasWidth = this.canvasWidth / this.r;\r\n        const canvasHeight = this.canvasHeight / this.r;\r\n\r\n        if (this.hasScrollBarX && this.hasScrollBarY && x > canvasWidth - this.scrollbarSize && y > canvasHeight - this.scrollbarSize) {\r\n            if (this.isOverScrollUpY || this.isOverScollThumbY || this.isOverScrollDownY || this.isOverScrollUpX || this.isOverScollThumbX || this.isOverScrollDownX) {\r\n                this.isOverScrollUpY = false;\r\n                this.isOverScollThumbY = false;\r\n                this.isOverScrollDownY = false;\r\n                this.isOverScrollUpX = false;\r\n                this.isOverScollThumbX = false;\r\n                this.isOverScrollDownX = false;\r\n                this.drawMe();\r\n            }\r\n            return true;\r\n        }\r\n            \r\n        if (( this.hasScrollBarX &&  this.hasScrollBarY && x < canvasWidth - this.scrollbarSize && y < canvasHeight - this.scrollbarSize) || \r\n            (!this.hasScrollBarX &&  this.hasScrollBarY && x < canvasWidth - this.scrollbarSize) ||\r\n            ( this.hasScrollBarX && !this.hasScrollBarY && y < canvasHeight - this.scrollbarSize) ) {\r\n            if (this.isOverScrollUpY || this.isOverScollThumbY || this.isOverScrollDownY || this.isOverScrollUpX || this.isOverScollThumbX || this.isOverScrollDownX) {\r\n                this.isOverScrollUpY = false;\r\n                this.isOverScollThumbY = false;\r\n                this.isOverScrollDownY = false;\r\n                this.isOverScrollUpX = false;\r\n                this.isOverScollThumbX = false;\r\n                this.isOverScrollDownX = false;\r\n                this.drawMe();\r\n            }\r\n            return false; \r\n        }    \r\n        \r\n        if (this.scrollBarThumbDownY) {\r\n            this.posY = this.scrollBarPosMaxY * ((y-20) / (this.canvasHeight / this.r-20*2));\r\n            return true;\r\n        }\r\n\r\n        if (this.scrollBarThumbDownX) {\r\n            this.posX = this.scrollBarPosMaxX * ((x) / (this.canvasWidth / this.r-20*2));\r\n            return true;\r\n        }\r\n        \r\n        if (this.hasScrollBarY && y < 20) {\r\n            if (!this.isOverScrollUpY || this.isOverScollThumbY || this.isOverScrollDownY || this.isOverScrollUpX || this.isOverScollThumbX || this.isOverScrollDownX)\r\n            {\r\n                this.isOverScrollUpY = true;\r\n                this.isOverScollThumbY = false;\r\n                this.isOverScrollDownY = false;\r\n                this.isOverScrollUpX = false;\r\n                this.isOverScollThumbX = false;\r\n                this.isOverScrollDownX = false;\r\n                this.drawMe();\r\n            }\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarY && x >= canvasWidth - this.scrollbarSize && y > this.canvasHeight / this.r - 20 - (this.hasScrollBarX?this.scrollbarSize:0)) {\r\n            if (this.isOverScrollUpY || this.isOverScollThumbY || !this.isOverScrollDownY || this.isOverScrollUpX || this.isOverScollThumbX || this.isOverScrollDownX)\r\n            {\r\n                this.isOverScrollUpY = false;\r\n                this.isOverScollThumbY = false;\r\n                this.isOverScrollDownY = true;\r\n                this.isOverScrollUpX = false;\r\n                this.isOverScollThumbX = false;\r\n                this.isOverScrollDownX = false;\r\n                this.drawMe();\r\n            }\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarY && this.scrollBarThumbMinY <= y && y <= this.scrollBarThumbMaxY) {\r\n            if (this.isOverScrollUpY || !this.isOverScollThumbY || this.isOverScrollDownY || this.isOverScrollUpX || this.isOverScollThumbX || this.isOverScrollDownX) {\r\n                this.isOverScrollUpY = false;\r\n                this.isOverScollThumbY = true;\r\n                this.isOverScrollDownY = false;\r\n                this.isOverScrollUpX = false;\r\n                this.isOverScollThumbX = false;\r\n                this.isOverScrollDownX = false;\r\n                this.drawMe();\r\n            }\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarX && x < 20) {\r\n            if (!this.isOverScrollUpX || this.isOverScollThumbX || this.isOverScrollDownX || this.isOverScrollUpY || !this.isOverScollThumbY || this.isOverScrollDownY)\r\n            {\r\n                this.isOverScrollUpX = true;\r\n                this.isOverScollThumbX = false;\r\n                this.isOverScrollDownX = false;\r\n                this.isOverScrollUpY = false;\r\n                this.isOverScollThumbY = false;\r\n                this.isOverScrollDownY = false;\r\n                this.drawMe();\r\n            }\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarX && y >= canvasHeight - this.scrollbarSize && x > this.canvasWidth / this.r - 20 - (this.hasScrollBarY?this.scrollbarSize:0)) {\r\n            if (this.isOverScrollUpY || this.isOverScollThumbY || this.isOverScrollDownY || this.isOverScrollUpX || this.isOverScollThumbX || !this.isOverScrollDownX)\r\n            {\r\n                this.isOverScrollUpY = false;\r\n                this.isOverScollThumbY = false;\r\n                this.isOverScrollDownY = false;\r\n                this.isOverScrollUpX = false;\r\n                this.isOverScollThumbX = false;\r\n                this.isOverScrollDownX = true;\r\n                this.drawMe();\r\n            }\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarX && this.scrollBarThumbMinX <= x && x <= this.scrollBarThumbMaxX) {\r\n            if (this.isOverScrollUpY || this.isOverScollThumbY || this.isOverScrollDownY || this.isOverScrollUpX || !this.isOverScollThumbX || this.isOverScrollDownX) {\r\n                this.isOverScrollUpY = false;\r\n                this.isOverScollThumbY = false;\r\n                this.isOverScrollDownY = false;\r\n                this.isOverScrollUpX = false;\r\n                this.isOverScollThumbX = true;\r\n                this.isOverScrollDownX = false;\r\n                this.drawMe();\r\n            }\r\n            return true;\r\n        }\r\n\r\n        if (this.isOverScrollUpY || this.isOverScollThumbY || this.isOverScrollDownY || this.isOverScrollUpX || this.isOverScollThumbX || this.isOverScrollDownX) {\r\n            this.isOverScrollUpY = false;\r\n            this.isOverScollThumbY = false;\r\n            this.isOverScrollDownY = false;\r\n            this.isOverScrollUpX = false;\r\n            this.isOverScollThumbX = false;\r\n            this.isOverScrollDownX = false;\r\n            this.drawMe();\r\n            return true;\r\n        }\r\n\r\n        return true;\r\n    }\r\n    public onMouseUp(x: number, y: number): boolean {\r\n        this.scrollBarThumbDownY = false;\r\n\r\n        this.isOverScollThumbY = false;\r\n        this.drawMe();\r\n\r\n        if (this.timeout) {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = undefined;\r\n            this.run = false;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private scrollClick(x: number, y: number, isTouch: boolean): boolean {\r\n        if (!this.hasScrollBarY && !this.hasScrollBarX) { return false; }\r\n\r\n        const canvasWidth = this.canvasWidth / this.r;\r\n        const canvasHeight = this.canvasHeight / this.r;\r\n        if (this.hasScrollBarX && this.hasScrollBarY && x > canvasWidth - this.scrollbarSize && y > canvasHeight - this.scrollbarSize) {\r\n            return true;\r\n        }\r\n            \r\n        if (( this.hasScrollBarX &&  this.hasScrollBarY && x < canvasWidth - this.scrollbarSize && y < canvasHeight - this.scrollbarSize) || \r\n            (!this.hasScrollBarX &&  this.hasScrollBarY && x < canvasWidth - this.scrollbarSize) ||\r\n            ( this.hasScrollBarX && !this.hasScrollBarY && y < canvasHeight - this.scrollbarSize) ) { \r\n            return false; \r\n        }            \r\n\r\n        if (this.hasScrollBarY && y < 20) {\r\n            if (this.posY === 0) { return true; }\r\n            this.posY -= this.cellHeight * this.r;\r\n            this.timeout = setTimeout(() => {\r\n                this.speed = +7;\r\n                this.runStart = -1;\r\n                this.runXOrY = true;\r\n                this.run = true;\r\n                this.drawable.askForReDraw();\r\n            }, 500);\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarY && x >= canvasWidth - this.scrollbarSize && y > canvasHeight - 20 - (this.hasScrollBarX?this.scrollbarSize:0)) {\r\n            if (this.posY === this.scrollBarPosMaxY) { return true; }\r\n            this.posY += this.cellHeight * this.r;\r\n            this.timeout = setTimeout(() => {\r\n                this.speed = -7;\r\n                this.runStart = -1;\r\n                this.runXOrY = true;\r\n                this.run = true;\r\n                this.drawable.askForReDraw();\r\n            }, 500);\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarY && x >= canvasWidth - this.scrollbarSize && y > this.scrollBarThumbMaxY) {\r\n            this.posY += canvasHeight - 20; \r\n            this.timeout = setTimeout(() => {\r\n                this.speed = -14;\r\n                this.runStart = -1;\r\n                this.runXOrY = true;\r\n                this.run = true;\r\n                this.drawable.askForReDraw();\r\n            }, 500);\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarY && x >= canvasWidth - this.scrollbarSize && y < this.scrollBarThumbMinY) {\r\n            this.posY -= canvasHeight - 20 ;\r\n            this.timeout = setTimeout(() => {\r\n                this.speed = +14;\r\n                this.runStart = -1;\r\n                this.runXOrY = true;\r\n                this.run = true;\r\n                this.drawable.askForReDraw();\r\n            }, 500);\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarY && x >= canvasWidth - this.scrollbarSize){\r\n            this.scrollBarThumbDownY = true;\r\n        }\r\n\r\n        if (this.hasScrollBarX && x < 20) {\r\n            if (this.posX === 0) { return true; }\r\n            this.posX -= this.cellHeight * this.r;\r\n            this.timeout = setTimeout(() => {\r\n                this.speed = +7;\r\n                this.runStart = -1;\r\n                this.runXOrY = false;\r\n                this.run = true;\r\n                this.drawable.askForReDraw();\r\n            }, 500);\r\n            return true;\r\n        }\r\n\r\n        \r\n        if (this.hasScrollBarX && y >= canvasHeight - this.scrollbarSize && x > canvasWidth - 20 - (this.hasScrollBarY?this.scrollbarSize:0)) {\r\n            if (this.posX === this.scrollBarPosMaxY) { return true; }\r\n            this.posX += this.cellHeight * this.r;\r\n            this.timeout = setTimeout(() => {\r\n                this.speed = -7;\r\n                this.runStart = -1;\r\n                this.runXOrY = false;\r\n                this.run = true;\r\n                this.drawable.askForReDraw();\r\n            }, 500);\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarX && y >= canvasHeight - this.scrollbarSize && x > this.scrollBarThumbMaxX) {\r\n            this.posX += canvasHeight - 20; \r\n            this.timeout = setTimeout(() => {\r\n                this.speed = -14;\r\n                this.runStart = -1;\r\n                this.runXOrY = false;\r\n                this.run = true;\r\n                this.drawable.askForReDraw();\r\n            }, 500);\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarX && y >= canvasHeight - this.scrollbarSize && x < this.scrollBarThumbMinX) {\r\n            this.posX -= canvasHeight - 20 ;\r\n            this.timeout = setTimeout(() => {\r\n                this.speed = +14;\r\n                this.runStart = -1;\r\n                this.runXOrY = false;\r\n                this.run = true;\r\n                this.drawable.askForReDraw();\r\n            }, 500);\r\n            return true;\r\n        }\r\n\r\n        if (this.hasScrollBarX && y >= canvasHeight - this.scrollbarSize){\r\n            this.scrollBarThumbDownX = true;\r\n        }\r\n\r\n\r\n        if (!isTouch) {\r\n            this.askForExtentedMouseMoveAndMaouseUp.call(this.drawable);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private drawMe() {\r\n        if (!this.drawable.isPlanToRedraw()) {\r\n            this.draw();\r\n        }\r\n    }\r\n        \r\n    public draw() {\r\n        if (this.height === undefined || this.width === undefined) {\r\n            return;\r\n        }\r\n\r\n        if (this.hasScrollBarY) {\r\n            const canvasHeight = this.canvasHeight - (this.hasScrollBarX ? this.scrollbarSize*this.r:0);\r\n            const height = canvasHeight - this.r * 16 * 2;\r\n            const ratioY = this.scrollBarPosMaxY === 0 ? 1 : (this.posY / this.scrollBarPosMaxY);        \r\n            const scrollBarSizeY = Math.max(10 * this.r, (height / this.pageY));\r\n            const scrollBarPosY = 16 * this.r + ratioY * (height - scrollBarSizeY);            \r\n            this.scrollBarThumbMinY = scrollBarPosY / this.r;\r\n            this.scrollBarThumbMaxY = (scrollBarPosY + scrollBarSizeY) / this.r;\r\n                    \r\n\r\n            this.context.fillStyle = this.scrollViewConfig.backgroundColor;\r\n            this.context.fillRect(this.canvasWidth - this.r * this.scrollbarSize, 0, this.r * this.scrollbarSize, canvasHeight);\r\n\r\n            this.context.fillStyle = this.isOverScrollUpY ? this.scrollViewConfig.buttonHoverColor : this.scrollViewConfig.buttonColor;\r\n            this.context.beginPath();\r\n            this.context.moveTo(this.canvasWidth - this.r * 10, this.r * 3);\r\n            this.context.lineTo(this.canvasWidth - this.r * 18, this.r * 13);\r\n            this.context.lineTo(this.canvasWidth - this.r * 2, this.r * 13);\r\n            this.context.fill();\r\n\r\n            this.context.fillStyle = this.isOverScrollDownY ? this.scrollViewConfig.buttonHoverColor : this.scrollViewConfig.buttonColor;\r\n            this.context.beginPath();\r\n            this.context.moveTo(this.canvasWidth - this.r * 10, canvasHeight - this.r * 3);\r\n            this.context.lineTo(this.canvasWidth - this.r * 18, canvasHeight - this.r * 13);\r\n            this.context.lineTo(this.canvasWidth - this.r * 2, canvasHeight - this.r * 13);\r\n            this.context.fill();\r\n\r\n            this.context.fillStyle = this.isOverScollThumbY ? this.scrollViewConfig.buttonHoverColor : this.scrollViewConfig.buttonColor;\r\n    \r\n            this.context.beginPath();\r\n            this.context.moveTo(this.canvasWidth - this.r * this.scrollbarSize, scrollBarPosY);\r\n            this.context.lineTo(this.canvasWidth, scrollBarPosY);\r\n            this.context.lineTo(this.canvasWidth, scrollBarPosY + scrollBarSizeY);\r\n            this.context.lineTo(this.canvasWidth - this.r * this.scrollbarSize, scrollBarPosY + scrollBarSizeY);\r\n            this.context.fill();\r\n        }\r\n\r\n        if (this.hasScrollBarX) {\r\n            const canvasWidth = this.canvasWidth - (this.hasScrollBarY ? this.scrollbarSize*this.r:0);\r\n            const width = canvasWidth - this.r * 16 * 2;\r\n            const ratioX = this.scrollBarPosMaxX === 0 ? 1 : (this.posX / this.scrollBarPosMaxX);        \r\n            const scrollBarSizeX = Math.max(10 * this.r, (width / this.pageX));\r\n            const scrollBarPosX = 16 * this.r + ratioX * (width - scrollBarSizeX);\r\n            this.scrollBarThumbMinX = scrollBarPosX / this.r;\r\n            this.scrollBarThumbMaxX = (scrollBarPosX + scrollBarSizeX) / this.r;\r\n                    \r\n\r\n            this.context.fillStyle = this.scrollViewConfig.backgroundColor;\r\n            this.context.fillRect(0, this.canvasHeight - this.r * this.scrollbarSize, canvasWidth, this.r * this.scrollbarSize);\r\n\r\n            this.context.fillStyle = this.isOverScrollUpX ? this.scrollViewConfig.buttonHoverColor : this.scrollViewConfig.buttonColor;\r\n            this.context.beginPath();\r\n            this.context.moveTo(this.r * 3, this.canvasHeight - this.r * 10);\r\n            this.context.lineTo(this.r * 13, this.canvasHeight - this.r * 18);\r\n            this.context.lineTo(this.r * 13, this.canvasHeight - this.r * 2);\r\n            this.context.fill();\r\n\r\n            this.context.fillStyle = this.isOverScrollDownX ? this.scrollViewConfig.buttonHoverColor : this.scrollViewConfig.buttonColor;\r\n            this.context.beginPath();\r\n            this.context.moveTo(canvasWidth - this.r * 3, this.canvasHeight - this.r * 10);\r\n            this.context.lineTo(canvasWidth - this.r * 13, this.canvasHeight - this.r * 18);\r\n            this.context.lineTo(canvasWidth - this.r * 13, this.canvasHeight - this.r * 2);\r\n            this.context.fill();\r\n            \r\n            this.context.fillStyle = this.isOverScollThumbX ? this.scrollViewConfig.buttonHoverColor : this.scrollViewConfig.buttonColor;\r\n    \r\n            this.context.beginPath();\r\n            this.context.moveTo(scrollBarPosX, this.canvasHeight - this.r * this.scrollbarSize);\r\n            this.context.lineTo(scrollBarPosX, this.canvasHeight);\r\n            this.context.lineTo(scrollBarPosX + scrollBarSizeX, this.canvasHeight);\r\n            this.context.lineTo(scrollBarPosX + scrollBarSizeX, this.canvasHeight - this.r * this.scrollbarSize);\r\n            this.context.fill();\r\n        }\r\n        \r\n        if (this.hasScrollBarX && this.hasScrollBarY) {\r\n            this.context.fillStyle = this.scrollViewConfig.backgroundColor;\r\n            this.context.fillRect(this.canvasWidth - this.r * this.scrollbarSize, this.canvasHeight - this.r * this.scrollbarSize, this.r * this.scrollbarSize, this.r * this.scrollbarSize);   \r\n        }\r\n    }\r\n\r\n    private fixPos() {\r\n        if (!this.hasScrollBarY) {\r\n            this.posY = 0;\r\n            return;\r\n        }\r\n        \r\n        if (this.posY < 0) {\r\n            this.posY = 0;\r\n        }\r\n        else {\r\n            if (this.posY > this.scrollBarPosMaxY) {\r\n                this.posY = this.scrollBarPosMaxY;\r\n            }\r\n        }\r\n    }\r\n}","import { OffscreenCanvasTableWorker } from '../OffscreenCanvasTableWorker/src/OffscreenCanvasTableWorker';\r\nimport { CustomCanvasTable } from '../share/CustomCanvasTable';\r\nimport { CanvasTableColumnConf, Align, Sort } from '../share/CanvasTableColum';\r\n\r\nfunction customDraw(canvasTable: CustomCanvasTable, context: CanvasRenderingContext2D, rowIndex: number, col: CanvasTableColumnConf, left: number, top: number, right: number, bottom: number, width: number, height: number, r: number, dataValue: any, row: any, data: any): void {\r\n    context.fillStyle = \"lightgreen\";\r\n    context.fillRect(left, top, width, height);\r\n    context.strokeStyle = \"red\";\r\n    context.beginPath();\r\n    context.moveTo(left, top);\r\n    context.lineTo(right, bottom);\r\n\r\n    context.moveTo(left, bottom);\r\n    context.lineTo(right, top);\r\n\r\n    context.stroke();\r\n}\r\n\r\nconst col: CanvasTableColumnConf[] = [\r\n    {\r\n        header: \"Id\",\r\n        field: \"__rownum__\",\r\n        width: 80,\r\n        align: Align.center\r\n    },\r\n    {\r\n        header: \"Render\",\r\n        field: \"__rownum__\",\r\n        width: 80,\r\n        renderer: customDraw,\r\n        visible: true\r\n    },\r\n    {\r\n        header: \"Country\",\r\n        field: \"country\",\r\n        width: 100\r\n    },\r\n    {\r\n        header: \"Id\",\r\n        field: \"__rownum__\",\r\n        width: 30,\r\n        align: Align.right\r\n    },\r\n    {\r\n        header: \"Name\",\r\n        field: \"name\",\r\n        width: 200\r\n    },\r\n    {\r\n        header: \"Subcountry\",\r\n        field: \"subcountry\",\r\n        width: 200\r\n    },\r\n    {\r\n        header: \"geonameid\",\r\n        field: \"geonameid\",\r\n        width: 100,\r\n        align: Align.right\r\n    }\r\n];\r\nconst offscreenCanvasTableWorker = new OffscreenCanvasTableWorker(1, col);\r\noffscreenCanvasTableWorker.setSort([{ col: col[2], sort: Sort.ascending }, {col:col[5], sort:Sort.ascending}]);\r\n\r\n\r\n\r\nconst httpRequest = new XMLHttpRequest();\r\nhttpRequest.onreadystatechange = function() {\r\n    if (httpRequest.readyState === XMLHttpRequest.DONE) {\r\n        const data = JSON.parse(httpRequest.responseText);\r\n        offscreenCanvasTableWorker.setData(data);\r\n    }\r\n};\r\n\r\nhttpRequest.open('GET', '../data.json', true);\r\nhttpRequest.send();\r\n\r\n\r\naddEventListener('message', (message) => {\r\n    if (message.data.mthbCanvasTable !== undefined) {\r\n        offscreenCanvasTableWorker.message(message.data);\r\n        return;\r\n    }\r\n\r\n    console.log('in webworker', message);\r\n    postMessage('this is the response ' + message.data);\r\n});\r\n"],"sourceRoot":""}